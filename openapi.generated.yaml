openapi: 3.0.0
info:
  title: eBay Tool API (current routes)
  version: "1.0.0"
servers:
  - url: http://localhost:4321/api
paths:
  /users:
    post:
      summary: Create user
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/User'
      responses:
        '200':
          description: OK
  /users/{id}:
    get:
      summary: Get user by id
      parameters:
        - in: path
          name: id
          required: true
          schema: { type: integer }
      responses:
        '200': { description: OK }
    put:
      summary: Update user
      parameters:
        - in: path
          name: id
          required: true
          schema: { type: integer }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/User'
      responses:
        '200': { description: OK }
    delete:
      summary: Delete user
      parameters:
        - in: path
          name: id
          required: true
          schema: { type: integer }
      responses:
        '204': { description: No Content }
  /auth/ebay-auth-url:
    get:
      summary: Get eBay auth URL
      responses:
        '200': { description: OK }
  /auth/ebay-token:
    post:
      summary: Exchange eBay code for token
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                code:
                  type: string
      responses:
        '200': { description: OK }
  /auth/ebay-callback:
    get:
      summary: Handle eBay callback
      responses:
        '200': { description: OK }
  /accounts:
    post:
      summary: Create account
      responses:
        '200': { description: OK }
  /accounts/user/{userId}:
    get:
      summary: Get accounts by user
      parameters:
        - in: path
          name: userId
          required: true
          schema: { type: integer }
      responses:
        '200': { description: OK }
  /accounts/{id}:
    put:
      summary: Update account
      parameters:
        - in: path
          name: id
          required: true
          schema: { type: integer }
      responses:
        '200': { description: OK }
  /accounts/listings:
    get:
      summary: Get listings by account
      responses:
        '200': { description: OK }
  /orders/user:
    get:
      summary: Get orders by user
      parameters:
        - in: query
          name: userId
          schema: { type: integer }
      responses:
        '200': { description: OK }
  /orders/line-items/{lineItemId}/procurement-status:
    put:
      summary: Update procurement status
      parameters:
        - in: path
          name: lineItemId
          required: true
          schema: { type: string }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                procurementStatus:
                  type: string
      responses:
        '200': { description: OK }
  /orders/line-items/{lineItemId}/procurement-tracking:
    put:
      summary: Update procurement tracking
      parameters:
        - in: path
          name: lineItemId
          required: true
          schema: { type: string }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                procurementTrackingNumber:
                  type: string
      responses:
        '200': { description: OK }
  /orders/{orderNo}/tracking:
    post:
      summary: Upload eBay tracking for order
      parameters:
        - in: path
          name: orderNo
          required: true
          schema: { type: string }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                trackingNumber: { type: string }
                carrierCode: { type: string }
                shippingServiceCode: { type: string }
                shippedDate: { type: string }
      responses:
        '200': { description: OK }
  /orders/shipping-status/bulk:
    put:
      summary: Mark orders shipped in bulk
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                orderIds:
                  type: array
                  items: { type: integer }
      responses:
        '200': { description: OK }
  /orders/{orderId}:
    put:
      summary: Update order
      parameters:
        - in: path
          name: orderId
          required: true
          schema: { type: integer }
      responses:
        '200': { description: OK }
  /orders/sync-all-ebay-data/user/{userId}:
    get:
      summary: Sync orders from eBay
      parameters:
        - in: path
          name: userId
          required: true
          schema: { type: integer }
      responses:
        '200': { description: OK }
  /buyers/sync-buyers:
    get:
      summary: Sync buyers
      responses:
        '200': { description: OK }
  /buyers/user:
    get:
      summary: Get buyers by user
      parameters:
        - in: query
          name: userId
          schema: { type: integer }
      responses:
        '200': { description: OK }
  /buyers/{buyerId}:
    put:
      summary: Update buyer
      parameters:
        - in: path
          name: buyerId
          required: true
          schema: { type: integer }
      responses:
        '200': { description: OK }
  /sheets/sync-sheet:
    post:
      summary: Sync Google Sheet to Supabase
      responses:
        '200': { description: OK }
  /chatwork/last-week-orders/{userId}:
    get:
      summary: Send last week orders to Chatwork
      parameters:
        - in: path
          name: userId
          required: true
          schema: { type: integer }
      responses:
        '200': { description: OK }
  /inventory/inventory-update-history/{userId}:
    get:
      summary: Get inventory update history
      parameters:
        - in: path
          name: userId
          required: true
          schema: { type: integer }
      responses:
        '200': { description: OK }
  /inventory/update:
    post:
      summary: Update inventory from Octoparse data
      responses:
        '200': { description: OK }
  /tasks/save-task:
    post:
      summary: Save task
      responses:
        '200': { description: OK }
  /tasks/complete-task:
    post:
      summary: Mark task completed
      responses:
        '200': { description: OK }
  /tasks/task/{taskID}:
    get:
      summary: Get task by id
      parameters:
        - in: path
          name: taskID
          required: true
          schema: { type: string }
      responses:
        '200': { description: OK }
  /tasks/octoparse-tasks/{userId}:
    get:
      summary: Get octoparse tasks by user
      parameters:
        - in: path
          name: userId
          required: true
          schema: { type: integer }
      responses:
        '200': { description: OK }
  /tasks/delete/{taskId}:
    delete:
      summary: Delete task
      parameters:
        - in: path
          name: taskId
          required: true
          schema: { type: string }
      responses:
        '200': { description: OK }
  /octoparse/fetch-all-data:
    get:
      summary: Get all Octoparse data
      responses:
        '200': { description: OK }
  /octoparse/inventory-management:
    put:
      summary: Update inventory management flag
      responses:
        '200': { description: OK }
  /octoparse/delete-data:
    post:
      summary: Delete Octoparse data
      responses:
        '200': { description: OK }
  /octoparse/update-task-delete-flag:
    put:
      summary: Update Octoparse task delete flag
      responses:
        '200': { description: OK }
  /schedule/{taskId}:
    get:
      summary: Get schedules by task
      parameters:
        - in: path
          name: taskId
          required: true
          schema: { type: string }
      responses:
        '200': { description: OK }
  /schedule:
    post:
      summary: Save schedule
      responses:
        '200': { description: OK }
  /schedule/status/{taskId}:
    put:
      summary: Update schedule status
      parameters:
        - in: path
          name: taskId
          required: true
          schema: { type: string }
      responses:
        '200': { description: OK }
  /items/sync-active-listings:
    post:
      summary: Sync active listings (GetItem)
      responses:
        '200': { description: OK }
  /order-summary:
    get:
      summary: List orders for summary view
      responses:
        '200': { description: OK }
  /order-summary/summary:
    get:
      summary: Get aggregated order summary
      responses:
        '200': { description: OK }
  /order-summary/download-csv:
    get:
      summary: Download order summary CSV
      responses:
        '200': { description: OK }
  /listings-summary:
    get:
      summary: Get listings summary
      responses:
        '200': { description: OK }
  /listings-summary/download-csv:
    get:
      summary: Download listings summary CSV
      responses:
        '200': { description: OK }
  /message-templates/templates:
    post:
      summary: Create message template
      responses:
        '201': { description: Created }
    get:
      summary: List message templates
      responses:
        '200': { description: OK }
  /message-templates/templates/{template_id}:
    get:
      summary: Get message template
      parameters:
        - in: path
          name: template_id
          required: true
          schema: { type: integer }
      responses:
        '200': { description: OK }
    put:
      summary: Update message template
      parameters:
        - in: path
          name: template_id
          required: true
          schema: { type: integer }
      responses:
        '200': { description: OK }
    delete:
      summary: Delete message template
      parameters:
        - in: path
          name: template_id
          required: true
          schema: { type: integer }
      responses:
        '204': { description: No Content }
  /listings/sync:
    get:
      summary: Sync listings (legacy)
      parameters:
        - in: query
          name: userId
          schema: { type: integer }
      responses:
        '200': { description: OK }
  /listings/sync-ended-listings:
    get:
      summary: Sync ended listings
      parameters:
        - in: query
          name: userId
          schema: { type: integer }
      responses:
        '200': { description: OK }
  /csv/upload:
    post:
      summary: Upload CSV (generic)
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                file:
                  type: string
                  format: binary
      responses:
        '200': { description: OK }
  /csv/upload-acrive-listings:
    post:
      summary: Upload CSV (active listings)
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                file:
                  type: string
                  format: binary
      responses:
        '200': { description: OK }
  /categories/sync:
    get:
      summary: Sync categories
      responses:
        '200': { description: OK }
  /categories:
    get:
      summary: Get categories
      responses:
        '200': { description: OK }
  /categories/children/{parentCategoryId}:
    get:
      summary: Get child categories
      parameters:
        - in: path
          name: parentCategoryId
          required: true
          schema: { type: string }
      responses:
        '200': { description: OK }
  /item-search/search:
    post:
      summary: Search items
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              additionalProperties: true
      responses:
        '200': { description: OK }
  /marketing/send-offer/eligible:
    get:
      summary: Get send-offer eligible listings
      parameters:
        - in: query
          name: accountId
          required: true
          schema: { type: string }
        - in: query
          name: limit
          schema: { type: integer }
        - in: query
          name: offset
          schema: { type: integer }
      responses:
        '200': { description: OK }
  /webhooks:
    get:
      summary: List webhooks by account
      parameters:
        - in: query
          name: accountId
          required: true
          schema: { type: integer }
      responses:
        '200': { description: OK }
    post:
      summary: Create webhook
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                accountId: { type: integer }
                url: { type: string, format: uri }
                event_type: { type: string }
                is_active: { type: boolean }
      responses:
        '201': { description: Created }
components:
  schemas:
    User:
      type: object
      properties:
        id: { type: integer }
        username: { type: string }
        email: { type: string }
        password: { type: string }
